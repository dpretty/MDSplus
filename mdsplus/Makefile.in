#@(#)$RCSfile: Makefile.in,v $ $Revision: 1.12 $
# @configure_input@
SHELL=/bin/sh

JAVA_APS = javamds \
	   javascope \
           javatraverser

D3D_PACKAGE = d3dshr

PARTS = \
        mdsshr \
        treeshr \
        tdishr \
        tditest \
        xmdsshr \
        mdstcpip \
	tdic \
        dwscope \
        mitdevices \
        mdslibidl \
        remcam \
        cdu     \
        mdsdcl  \
        ccl     \
	servershr \
        tcl \
        traverser \
        actions \
        mdslib \
        math \
        @D3D_PACKAGE@ \
        wfevent \
        setevent \
        mdsremote \
        @JAVA_APS@ \
        @IDLSQL@ \
	@IDLMDSEVENT@ \
	@MDSVME@

all:
	cdir=`pwd`;\
	for dir in $(PARTS) ; do\
	  echo Making $${dir}; cd $${dir}; make all; cd $$cdir;\
	done

.IGNORE:

clean:
	cdir=`pwd`;\
	for dir in $(PARTS) ; do\
	  cd $${dir} && make -i clean; cd $$cdir;\
	done

depend:
	cdir=`pwd`;\
	for dir in $(PARTS) ; do\
	  cd $${dir}; make depend; cd $$cdir;\
	done

install: 
	cdir=`pwd`;\
	for dir in $(PARTS) ; do\
	  cd $${dir}; make install; cd $$cdir;\
	done
        mkdir @prefix@/mdsplus
	tar cf - etc tdi idl trees envsyms setup.sh setup.csh java LabView include | (cd @prefix@/mdsplus; tar xf -)

BINARIES = bin etc lib uid \
           tdi idl trees envsyms \
           setup.sh setup.csh java LabView \
           include/ipdesc.h include/mdslib.inc

CLIENT_BINARIES = include/ipdesc.h include/mdslib.inc lib/libMdsIpShr.* lib/libMdsLib*.* idl

binaries :
	tar cvf - $(BINARIES) | compress -c - > ../binaries/MDSplus.`uname`.tar.Z
	tar cvf - $(CLIENT_BINARIES) | compress -c - > ../binaries/MDSplus.`uname`.client.tar.Z


